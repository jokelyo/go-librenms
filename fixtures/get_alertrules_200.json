{
    "count": 12,
    "rules": [
        {
            "builder": "{\"condition\":\"AND\",\"rules\":[{\"id\":\"macros.device_down\",\"field\":\"macros.device_down\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"devices.status_reason\",\"field\":\"devices.status_reason\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"icmp\"}],\"valid\":true}",
            "devices": [
                13
            ],
            "disabled": 0,
            "extra": "{\"mute\":false,\"count\":\"-1\",\"delay\":300,\"invert\":false,\"interval\":300,\"recovery\":true,\"acknowledgement\":true,\"options\":{\"override_query\":null}}",
            "groups": [
                1
            ],
            "id": 1,
            "invert_map": 0,
            "locations": [
                1
            ],
            "name": "Device Down! Due to no ICMP response.",
            "notes": "",
            "proc": "",
            "query": "SELECT * FROM devices WHERE (devices.device_id = ?) AND (devices.status = 0 && (devices.disabled = 0 && devices.ignore = 0)) = 1 AND devices.status_reason = \"icmp\"",
            "rule": "",
            "severity": "critical"
        },
        {
            "builder": "{\"condition\":\"AND\",\"rules\":[{\"id\":\"macros.device_down\",\"field\":\"macros.device_down\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"devices.status_reason\",\"field\":\"devices.status_reason\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"snmp\"}],\"valid\":true}",
            "devices": [
                13
            ],
            "disabled": 0,
            "extra": "{\"mute\":false,\"count\":\"-1\",\"delay\":300,\"invert\":false,\"interval\":300,\"recovery\":true,\"acknowledgement\":true,\"options\":{\"override_query\":null}}",
            "groups": [],
            "id": 2,
            "invert_map": 0,
            "locations": [],
            "name": "Device Down (SNMP unreachable)",
            "notes": "",
            "proc": "",
            "query": "SELECT * FROM devices WHERE (devices.device_id = ?) AND (devices.status = 0 && (devices.disabled = 0 && devices.ignore = 0)) = 1 AND devices.status_reason = \"snmp\"",
            "rule": "",
            "severity": "critical"
        },
        {
            "builder": "{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.uptime\",\"field\":\"devices.uptime\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"less\",\"value\":\"300\"},{\"id\":\"macros.device\",\"field\":\"macros.device\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"}],\"valid\":true}",
            "devices": [],
            "disabled": 0,
            "extra": "{\"mute\":false,\"count\":1,\"delay\":300,\"invert\":false,\"interval\":300}",
            "groups": [],
            "id": 3,
            "invert_map": 0,
            "locations": [],
            "name": "Device rebooted",
            "notes": null,
            "proc": null,
            "query": "SELECT * FROM devices WHERE (devices.device_id = ?) AND devices.uptime < 300 AND (devices.disabled = 0 && devices.ignore = 0) = 1",
            "rule": "",
            "severity": "critical"
        },
        {
            "builder": "{\"condition\":\"AND\",\"rules\":[{\"id\":\"macros.port_down\",\"field\":\"macros.port_down\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"}],\"valid\":true}",
            "devices": [],
            "disabled": 0,
            "extra": "{\"mute\":false,\"count\":1,\"delay\":300,\"invert\":false,\"interval\":300}",
            "groups": [],
            "id": 4,
            "invert_map": 0,
            "locations": [],
            "name": "Port status up/down",
            "notes": null,
            "proc": null,
            "query": "SELECT * FROM devices,ports WHERE (devices.device_id = ? AND devices.device_id = ports.device_id) AND (ports.ifOperStatus = \"down\" && ports.ifAdminStatus != \"down\" && (ports.deleted = 0 && ports.ignore = 0 && ports.disabled = 0)) = 1",
            "rule": "",
            "severity": "critical"
        },
        {
            "builder": "{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.last_ping_timetaken\",\"field\":\"devices.last_ping_timetaken\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"greater\",\"value\":\"10\"}],\"valid\":true}",
            "devices": [],
            "disabled": 0,
            "extra": "{\"mute\":false,\"count\":-1,\"delay\":300,\"invert\":false,\"interval\":300}",
            "groups": [],
            "id": 5,
            "invert_map": 0,
            "locations": [],
            "name": "Ping Latency",
            "notes": null,
            "proc": null,
            "query": "SELECT * FROM devices WHERE (devices.device_id = ?) AND devices.last_ping_timetaken > 10",
            "rule": "",
            "severity": "critical"
        },
        {
            "builder": "{\"condition\":\"AND\",\"rules\":[{\"id\":\"macros.port_usage_perc\",\"field\":\"macros.port_usage_perc\",\"type\":\"integer\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"80\"},{\"id\":\"macros.port_up\",\"field\":\"macros.port_up\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"}],\"valid\":true}",
            "devices": [],
            "disabled": 0,
            "extra": "{\"mute\":false,\"count\":-1,\"delay\":300,\"invert\":false,\"interval\":300}",
            "groups": [],
            "id": 6,
            "invert_map": 0,
            "locations": [],
            "name": "Port utilisation over threshold",
            "notes": null,
            "proc": null,
            "query": "SELECT * FROM devices,ports WHERE (devices.device_id = ? AND devices.device_id = ports.device_id) AND (((SELECT IF(ports.ifOutOctets_rate>ports.ifInOctets_rate, ports.ifOutOctets_rate, ports.ifInOctets_rate)*8) / ports.ifSpeed)*100) >= 80 AND (ports.ifOperStatus = \"up\" && ports.ifAdminStatus = \"up\" && (ports.deleted = 0 && ports.ignore = 0 && ports.disabled = 0)) = 1",
            "rule": "",
            "severity": "critical"
        },
        {
            "builder": "{\"condition\":\"AND\",\"rules\":[{\"id\":\"sensors.sensor_current\",\"field\":\"sensors.sensor_current\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"greater\",\"value\":\"`sensors.sensor_limit`\"},{\"id\":\"sensors.sensor_alert\",\"field\":\"sensors.sensor_alert\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"macros.device_up\",\"field\":\"macros.device_up\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"}],\"valid\":true}",
            "devices": [],
            "disabled": 0,
            "extra": "{\"mute\":false,\"count\":-1,\"delay\":300,\"invert\":false,\"interval\":300}",
            "groups": [],
            "id": 7,
            "invert_map": 0,
            "locations": [],
            "name": "Sensor over limit - Check Device Health Settings",
            "notes": null,
            "proc": null,
            "query": "SELECT * FROM devices,sensors WHERE (devices.device_id = ? AND devices.device_id = sensors.device_id) AND sensors.sensor_current > sensors.sensor_limit AND sensors.sensor_alert = 1 AND (devices.status = 1 && (devices.disabled = 0 && devices.ignore = 0)) = 1",
            "rule": "",
            "severity": "critical"
        },
        {
            "builder": "{\"condition\":\"AND\",\"rules\":[{\"id\":\"sensors.sensor_current\",\"field\":\"sensors.sensor_current\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"less\",\"value\":\"`sensors.sensor_limit_low`\"},{\"id\":\"sensors.sensor_alert\",\"field\":\"sensors.sensor_alert\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"macros.device_up\",\"field\":\"macros.device_up\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"}],\"valid\":true}",
            "devices": [],
            "disabled": 0,
            "extra": "{\"mute\":false,\"count\":-1,\"delay\":300,\"invert\":false,\"interval\":300}",
            "groups": [],
            "id": 8,
            "invert_map": 0,
            "locations": [],
            "name": "Sensor under limit - Check Device Health Settings",
            "notes": null,
            "proc": null,
            "query": "SELECT * FROM devices,sensors WHERE (devices.device_id = ? AND devices.device_id = sensors.device_id) AND sensors.sensor_current < sensors.sensor_limit_low AND sensors.sensor_alert = 1 AND (devices.status = 1 && (devices.disabled = 0 && devices.ignore = 0)) = 1",
            "rule": "",
            "severity": "critical"
        },
        {
            "builder": "{\"condition\":\"AND\",\"rules\":[{\"id\":\"services.service_status\",\"field\":\"services.service_status\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"not_equal\",\"value\":\"0\"},{\"id\":\"macros.device_up\",\"field\":\"macros.device_up\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"}],\"valid\":true}",
            "devices": [],
            "disabled": 0,
            "extra": "{\"mute\":false,\"count\":-1,\"delay\":300,\"invert\":false,\"interval\":300}",
            "groups": [],
            "id": 9,
            "invert_map": 0,
            "locations": [],
            "name": "Service up/down",
            "notes": null,
            "proc": null,
            "query": "SELECT * FROM devices,services WHERE (devices.device_id = ? AND devices.device_id = services.device_id) AND services.service_status != 0 AND (devices.status = 1 && (devices.disabled = 0 && devices.ignore = 0)) = 1",
            "rule": "",
            "severity": "critical"
        },
        {
            "builder": "{\"condition\":\"AND\",\"rules\":[{\"id\":\"wireless_sensors.sensor_current\",\"field\":\"wireless_sensors.sensor_current\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`wireless_sensors.sensor_limit`\"},{\"id\":\"wireless_sensors.sensor_alert\",\"field\":\"wireless_sensors.sensor_alert\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"macros.device_up\",\"field\":\"macros.device_up\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"}],\"valid\":true}",
            "devices": [],
            "disabled": 0,
            "extra": "{\"mute\":false,\"count\":-1,\"delay\":300,\"invert\":false,\"interval\":300}",
            "groups": [],
            "id": 10,
            "invert_map": 0,
            "locations": [],
            "name": "Wireless Sensor over limit",
            "notes": null,
            "proc": null,
            "query": "SELECT * FROM devices,wireless_sensors WHERE (devices.device_id = ? AND devices.device_id = wireless_sensors.device_id) AND wireless_sensors.sensor_current >= wireless_sensors.sensor_limit AND wireless_sensors.sensor_alert = 1 AND (devices.status = 1 && (devices.disabled = 0 && devices.ignore = 0)) = 1",
            "rule": "",
            "severity": "critical"
        },
        {
            "builder": "{\"condition\":\"AND\",\"rules\":[{\"id\":\"wireless_sensors.sensor_current\",\"field\":\"wireless_sensors.sensor_current\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"less_or_equal\",\"value\":\"`wireless_sensors.sensor_limit_low`\"},{\"id\":\"wireless_sensors.sensor_alert\",\"field\":\"wireless_sensors.sensor_alert\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"macros.device_up\",\"field\":\"macros.device_up\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"}],\"valid\":true}",
            "devices": [],
            "disabled": 0,
            "extra": "{\"mute\":false,\"count\":-1,\"delay\":300,\"invert\":false,\"interval\":300}",
            "groups": [],
            "id": 11,
            "invert_map": 0,
            "locations": [],
            "name": "Wireless Sensor under limit",
            "notes": null,
            "proc": null,
            "query": "SELECT * FROM devices,wireless_sensors WHERE (devices.device_id = ? AND devices.device_id = wireless_sensors.device_id) AND wireless_sensors.sensor_current <= wireless_sensors.sensor_limit_low AND wireless_sensors.sensor_alert = 1 AND (devices.status = 1 && (devices.disabled = 0 && devices.ignore = 0)) = 1",
            "rule": "",
            "severity": "critical"
        },
        {
            "builder": "{\"condition\":\"AND\",\"rules\":[{\"id\":\"macros.state_sensor_critical\",\"field\":\"macros.state_sensor_critical\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"sensors.sensor_alert\",\"field\":\"sensors.sensor_alert\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"1\"}],\"valid\":true}",
            "devices": [],
            "disabled": 0,
            "extra": "{\"mute\":false,\"count\":-1,\"delay\":300,\"invert\":false,\"interval\":300}",
            "groups": [],
            "id": 12,
            "invert_map": 0,
            "locations": [],
            "name": "State Sensor Critical",
            "notes": null,
            "proc": null,
            "query": "SELECT * FROM devices,sensors,sensors_to_state_indexes,state_indexes,state_translations WHERE (devices.device_id = ? AND devices.device_id = sensors.device_id AND sensors.sensor_id = sensors_to_state_indexes.sensor_id AND sensors_to_state_indexes.state_index_id = state_indexes.state_index_id AND state_indexes.state_index_id = state_translations.state_index_id) AND (sensors.sensor_current = state_translations.state_value && state_translations.state_generic_value = 2) = 1 AND sensors.sensor_alert = 1",
            "rule": "",
            "severity": "critical"
        }
    ],
    "status": "ok"
}
